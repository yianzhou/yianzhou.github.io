# 比特币

比特币价格从 2010 年“1 万枚买两个披萨”涨至如今的数万美元。

2008 年中本聪发布白皮书，2009 年发布比特币钱包软件。

比特币软件只是普通的电脑程序，运行后连接“种子节点”（Seed Nodes，如中本聪的 IP）。节点间相互分享 IP 并建立连接，形成去中心化的 P2P（点对点）网络。

[种子节点](https://github.com/bitcoin/bitcoin/blob/master/contrib/seeds/nodes_main.txt)

钱包地址：类似银行卡号，由软件本地生成。

去中心化记账：没有中央账本，每个人都负责记账。电脑内存中开辟空间（内存池）存放临时交易记录。

Coinbase 铸币交易：区块的第一笔交易通常是凭空发给矿工的奖励（最初是 50 BTC，每 4 年减半）。经历了 2012、2016、2020、2024 年的减半，目前的奖励是 3.125 BTC。

区块头 (Block Header) 的关键要素：

- 交易哈希树：将区块内所有交易进行哈希运算得到的数值。
- 上一区块哈希：链接前一个区块，形成链条（创世区块此项为 0）。
- 时间戳：当前时间。
- 难度目标 (Bits)：规定哈希值必须小于的数值。
- 随机数 (Nonce)：用于挖矿碰撞的数字。

哈希算法 (Hash) 的特性：

- 雪崩效应：输入数据的微小改动（如改一个标点）会导致结果天翻地覆。
- 不可逆性：无法通过哈希值反推原文。
- 唯一性：相同数据的哈希结果永远一致。

挖矿的本质 (Mining) 是不断修改区块头中的随机数 (Nonce)，进行 SHA256 哈希运算，直到算出的哈希值小于网络规定的目标值 (Bits)。

设计目标是平均每 10 分钟出一个区块。每 2016 个区块（约 2 周）检查一次，若太快则增加难度（目标值变小，前缀 0 变多），太慢则降低难度。

一旦算出符合要求的哈希，广播给全网，其他节点验证通过后存入本地数据库。

最长链原则：全网只承认最长的那条链。

流程：当第一个区块产生后，所有矿工立即引用该区块哈希，开始挖第二个区块。谁先算出，谁就赢得记账权和奖励。

比特币没有“余额”概念，只有未花费的交易输出 (UTXO)。

例子：你有 50 BTC，要转给别人 9 BTC。你需要把 50 BTC 全部花掉：9 BTC 给对方，40 BTC 转回给自己，剩余 1 BTC 作为手续费。

手续费：给矿工的打包费。手续费越高，交易在内存池中越优先被打包。

确认状态：交易广播后先进入内存池（未确认），被矿工打包进区块后才算“确认”交易。

链式结构：篡改区块 1 会导致其哈希变化，导致区块 2 引用的哈希对不上，链条断裂。

51%算力攻击：理论上若某人算力超过全网其他人之和，可从过去某个区块重挖并超越现有主链（改写历史）。但在当前算力规模下（900 EH/s），几乎不可能实现。

## 安全性

比特币的账本之所以无法被篡改，是因为**篡改的代价远远高于篡改所能获得的收益**。

如果仅仅是重算哈希值，现代计算机一秒钟能算几十亿次，似乎不难。但比特币引入了**PoW（挖矿）**机制，让重算变得极其昂贵。

挖矿不是简单的计算，而是要找到一个小于特定目标值（Difficulty）的哈希。这是一个纯概率的“掷骰子”过程。

比特币网络中的所有节点只承认最长的那条链。攻击者如果要篡改以前的区块，他不仅要重新计算那个区块的哈希，还必须重新完成从那个区块到现在所有区块的挖矿工作量。

目前全网算力高达 900 EH/s（即每秒 900 亿亿次哈希计算）。这意味着，要重写历史，你需要消耗通过燃烧天量电力产生的巨大算力。

假设你想篡改账本，你自己偷偷挖了一条“假链”。与此同时，全网其他诚实的矿工（占绝大多数算力）正在现有的“真链”上继续拼命挖新的区块。因为你的算力比全网总和低，你挖矿的速度一定比大部队慢。你的“假链”永远追不上“真链”的长度。当你把假链广播出去时，会被所有节点当作“短链”直接丢弃。除非你能掌控全网 51%以上 的算力，你才能比全网其他人挖得快，从而让你的“假链”成为最长链。但在现实中，要获得超过全网 900 EH/s 的算力，需要数百亿美元的硬件投入和国家级的电力支持，在经济上几乎是不可能的。
